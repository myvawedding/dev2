"use strict";!function(n){DRTS.Location.api.geocode=function(e,r,t){var o={format:"json",limit:1,q:e,"accept-language":DRTS_Location_nominatimGeocoding.language};console.log("Nominatim geocoding request:",o),n.getJSON("https://nominatim.openstreetmap.org/search",o).done(function(e){if(console.log("Nominatim geocoding results:",e),!e.length){var o=new Error("Geocoder returned no address components");if(t)return void t(o);throw o}r([e[0].lat,e[0].lon])}).fail(function(e,o,r){var n=new Error("Geocoder failed due to: "+r+"("+o+")");if(!t)throw n;t(n)})},DRTS.Location.api.reverseGeocode=function(e,a,i){var o={format:"json",addressdetails:1,zoom:18,lat:e[0],lon:e[1],"accept-language":DRTS_Location_nominatimGeocoding.language};console.log("Nominatim reverse geocoding request:",o),n.getJSON("https://nominatim.openstreetmap.org/reverse",o).done(function(e){if(console.log("Nominatim reverse geocoding results:",e),e.error){var o=new Error(e.error);if(i)return void i(o);throw o}if(!1 in e||!1 in e){var r=new Error("Geocoder returned no address components");if(i)return void i(r);throw r}var n={address:e.display_name,viewport:[e.boundingbox[0],e.boundingbox[2],e.boundingbox[1],e.boundingbox[3]]};for(var t in e.address)switch(t){case"road":n.street=e.address[t];break;case"village":n.city=e.address[t];break;case"state":n.province=e.address[t];break;case"postcode":n.zip=e.address[t];break;case"country_code":n.country=e.address[t].toUpperCase();break;default:n[t]=e.address[t]}"house_number"in n&&"street"in n&&(DRTS_Location_nominatimGeocoding.streetNumAfter?n.street=n.street+" "+n.house_number:n.street=n.house_number+" "+n.street),a(n)}).fail(function(e,o,r){var n=new Error("Geocoder failed due to: "+r+"("+o+")");if(!i)throw n;i(n)})}}(jQuery);