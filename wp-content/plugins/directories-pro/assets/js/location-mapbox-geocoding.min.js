"use strict";!function(a){DRTS.Location.api.geocode=function(o,n,r){var e="https://api.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(o)+".json",t={access_token:DRTS_Location_mapboxGeocoding.accessToken,language:DRTS_Location_mapboxGeocoding.language,limit:1};DRTS_Location_mapboxGeocoding.country&&(t.country=DRTS_Location_mapboxGeocoding.country),console.log("Mapbox geocoding url:",e),console.log("Mapbox geocoding request:",t),a.getJSON(e,t).done(function(o){if(console.log("Mapbox geocoding results:",o),!1 in o||!o.features.length){var e=new Error("Geocoder returned no address components");if(r)return void r(e);throw e}n([o.features[0].center[1],o.features[0].center[0]])}).fail(function(o,e,n){var t=new Error("Geocoder failed due to: "+n+"("+e+")");if(!r)throw t;r(t)})},DRTS.Location.api.reverseGeocode=function(o,u,g){var e="https://api.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(o[1]+","+o[0])+".json",n={access_token:DRTS_Location_mapboxGeocoding.accessToken,language:DRTS_Location_mapboxGeocoding.language,limit:1};DRTS_Location_mapboxGeocoding.country&&(n.country=DRTS_Location_mapboxGeocoding.country),console.log("Mapbox reverse geocoding url:",e),console.log("Mapbox reverse geocoding request:",n),a.getJSON(e,n).done(function(o){if(console.log("Mapbox reverse geocoding results:",o),!1 in o||!o.features.length){var e=new Error("Geocoder returned no address components");if(g)return void g(e);throw e}var n={address:o.features[0].place_name,street:[o.features[0].address||"",o.features[0].text||""].join(" ")};o.features[0].bbox&&(n.viewport=[o.features[0].bbox[1],o.features[0].bbox[0],o.features[0].bbox[3],o.features[0].bbox[2]]);var t=void 0,r=!0,a=!1,c=void 0;try{for(var i,s=o.features[0].context[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var d=i.value;switch(t=d.id.substr(0,d.id.indexOf("."))){case"place":n.city=d.text;break;case"region":n.province=d.text;break;case"postcode":n.zip=d.text;break;case"country":n.country=d.short_code.toUpperCase();break;default:n[t]=d.text}}}catch(e){a=!0,c=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw c}}u(n)}).fail(function(o,e,n){var t=new Error("Geocoder failed due to: "+n+"("+e+")");if(!g)throw t;g(t)})}}(jQuery);