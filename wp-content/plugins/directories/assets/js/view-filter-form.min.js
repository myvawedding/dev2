"use strict";!function(f){DRTS.View=DRTS.View||{},DRTS.View.filterForm=DRTS.View.filterForm||function(a){var e,s,o=f(a);((e=f(o.data("entities-container"))).length&&(s=e.find(o.data("entities-target"))).length&&s.off("click").on("click",".drts-view-entities-filters-applied .drts-view-remove-filter",function(e){var t=f(this);e.preventDefault(),t.remove(),t.data("filter-name")?DRTS.View.removeFilter(o,t.data("filter-name"),t.data("filter-value")):s.find(".drts-view-entities-filters-applied .drts-view-remove-filter").each(function(){var e=f(this);e.remove(),DRTS.View.removeFilter(o,e.data("filter-name"),e.data("filter-value"))}),o.submit()}),o.on("submit",function(e){if(o.find("[placeholder]").each(function(){var e=f(this);e.val()==e.attr("placeholder")&&e.val("")}),s&&s.length){e.preventDefault();var r,t,i=o.serialize(),a=s.find(".drts-view-entities-sort-selected").data("value"),n=s.find(".drts-view-entities-perpage-selected").data("value"),l=o.attr("action"),d=!(!o.closest("#drts-modal").length||!o.is(":visible"));a&&(i+="&sort="+a),n&&(i+="&num="+n),t={type:"post",container:o.data("entities-container"),target:o.data("entities-target"),url:l,data:i,pushState:!!o.data("push-state"),pushStateUrl:l+(-1<l.indexOf("?")?"&":"?")+i,scroll:!0,loadingImage:!0},d&&f("#drts-modal").sabaiModal("hide"),o.data("external")&&(t.url+=(-1<t.url.indexOf("?")?"&":"?")+DRTS.params.contentType+"=json",t.onContent=function(e,t,i,a){f("body > .select2-container").remove(),r=f(o.data("entities-container")+"-view-filter-form"),o.remove(),r.html(e.filter_form),DRTS.init(r)},t.onError=function(e,t,i,a){}),DRTS.ajax(t)}}).on("change.sabai",function(e){if(!o.parent(".drts-view-filter-form-manual").length&&!o.closest("#drts-modal").length){var t=f(e.target),i=t.closest(".drts-view-filter-ignore");if(i.length){if(!i.data("ignore-element-name")||void 0===i.data("ignore-element-value"))return;var a=i.find('[name="'+i.data("ignore-element-name")+'"]');if(a.length&&a.attr("name")!==t.attr("name")&&a.val()===i.data("ignore-element-value"))return}var r=f(o.data("entities-container")+"-view-filter-form");r.length&&r.data("collapsible")&&r.sabaiCollapse("hide"),o.submit()}}).find(".drts-view-filter-trigger").on("click",function(e){e.preventDefault(),f(this).addClass(DRTS.bsPrefix+"disabled"),o.submit()}),o.closest("#drts-modal").length)&&(f("#drts-modal").find(".drts-form-buttons").find("button").on("click",function(e){e.preventDefault(),f(this).addClass(DRTS.bsPrefix+"disabled"),o.submit()}),o.find("."+DRTS.bsPrefix+"card-group-none").removeClass(DRTS.bsPrefix+"card-group-none").addClass(DRTS.bsPrefix+"card-group"));f("#drts-content").on("entity_entities_filter_removed.sabai",function(e,t,i){DRTS.View.removeFilter(f(a),t,i)}),f(DRTS).on("location_exit_fullscreen.sabai",function(e,t){f("#drts-modal").find("."+DRTS.bsPrefix+"modal-title,."+DRTS.bsPrefix+"modal-body,."+DRTS.bsPrefix+"modal-footer").empty()})},DRTS.View.removeFilter=DRTS.View.removeFilter||function(e,t,i){if(t){var a=e.find('[data-view-filter-name="'+t+'"]');if(!a.length)return;switch(a.data("view-filter-form-type")){case"textfield":case"hidden":a.find('input[name="'+t+'"]').val("");break;case"checkboxes":i?a.find('input:checkbox[value="'+i+'"]').prop("checked",!1):a.find('input:checkbox[name="'+t+'[]"]').prop("checked",!1);break;case"radios":i?a.find('input:radio[value="'+i+'"]').prop("checked",!1):a.find('input:radio[name="'+t+'"]').prop("checked",!1),a.find('input:radio[value=""]').prop("checked",!0);break;case"select":var r=a.find('select[name^="'+t+'["]');r.length?r.each(function(e){var t=f(this);0<e?t.val("").closest(".drts-form-type-select").hide():t.val(""),t.hasClass("select2-hidden-accessible")&&t.select2("close")}):a.find('select[name="'+t+'"]').val("");break;case"slider":var n=a.find(".drts-form-slider");n.length&&n.data("ionRangeSlider").update({from:n.data("min"),to:n.data("max")})}var l=a.find(".drts-entity-reset-form-field-target");(l.length?l:a).trigger("entity_reset_form_field.sabai",[t])}else e.find(".drts-view-filter-form-field").each(function(){var e=f(this);e.data("view-filter-name")&&f("#drts-content").trigger("entity_entities_filter_removed.sabai",[e.data("view-filter-name"),null,!0])})}}(jQuery);