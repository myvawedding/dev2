"use strict";!function(s){DRTS.Voting=DRTS.Voting||{},DRTS.Voting.rating=DRTS.Voting.rating||function(t,a){var n=s(t);if(n.length){var o=n.find("select");if(o.length){var i=o.val();a=a||{},n.data("vote-url")&&(a.url=n.data("vote-url")),n.data("vote-rating")&&(a.initialRating=n.data("vote-rating"));var r=s.extend({},DRTS.Voting.rating.defaults,a);r.url&&(r.onSelect=function(t,a,e){e&&(o.barrating("readonly",!0),n.fadeTo(600,.4,function(){s.ajax({url:r.url,type:"post",data:"value="+(t||i),complete:function(t){try{var e=JSON.parse(t.responseText.replace(/<!--[\s\S]*?-->/g,""))}catch(t){return void console.log(t.toString())}278==t.status||200==t.status?n.fadeTo(600,.1,function(){var t=void 0!==e.average&&e.average?parseFloat(e.average):0,a=void 0!==e.count?e.count?parseInt(e.count):0:1;n.parent().find(".drts-voting-rating-average").text(t.toFixed(2)).end().find(".drts-voting-rating-count").text(a),o.val(e.level).barrating("set",e.level),n.fadeTo(600,1)}):(n.fadeTo("fast",1),e.messages?DRTS.flash(e.messages,"danger"):console.log(e))}})}))}),o.barrating(r)}}},DRTS.Voting.rating.defaults={theme:"fontawesome-stars-o",url:location.href,showSelectedRating:!1,showValues:!1,allowEmpty:!0},s(DRTS).on("loaded.sabai drts_init.sabai",function(t,a){s(".drts-voting-rating-select",a.context).each(function(){DRTS.Voting.rating(s(this))})})}(jQuery);